# 🕵️‍♂️ マーダーミステリーGM支援Bot 操作マニュアル

このBotは、Discord上で行うマーダーミステリー（マダミス）の進行を補助するツールです。
会場の設営、配役、密談からの集合、撤収作業を自動化します。

---

## 📋 目次
1. [事前準備（GM権限の設定）](#1-事前準備gm権限の設定)
2. [会場の設営](#2-会場の設営)
3. [配役（キャラクター決定）](#3-配役キャラクター決定)
4. [ゲーム中の進行（タイマー・移動）](#4-ゲーム中の進行タイマー移動)
5. [セッション終了後（片付け）](#5-セッション終了後片付け)
6. [コマンド一覧表](#6-コマンド一覧表)

---

## 1. 事前準備（GM権限の設定）

Botを導入したら、まずは自分（進行役）に**GM権限**を付与します。

### 👑 GMを設定する
!setgm @自分

* **機能:** 指定したユーザーに「GM」ロールを付与します。
* **効果:** Botが作成する**全ての隠し部屋（テキスト・ボイス）**が見えるようになります。また、移動コマンドの対象外になります。

### 🎧 サブアカウント（録音・配信など）を設定する
!setsub @サブ垢の名前

* **機能:** 指定したユーザーに「GMサブ」ロールを付与します。
* **効果:** GMと同様に全部屋に入室でき、移動コマンドで飛ばされなくなります。録音用Botや、聞き専端末に使います。

---

## 2. 会場の設営

シナリオに必要なキャラクター部屋を作成します。

### 🏗️ 会場をセットアップする
!setup キャラ名1 キャラ名2 キャラ名3 ...

* **使用例:** `!setup 探偵 犯人 執事 メイド`
* **機能:**
    1. **常設部屋の確認:** 「GM控室」「全体議論」「密談部屋(1,2)」がなければ作成し、あれば再利用します。
    2. **個別部屋の作成:** 入力したキャラクター名ごとの「専用テキストチャンネル」と「ロール」を新規作成します。
    3. **権限更新:** 新しく作ったキャラクターが「全体議論」や「密談部屋」に入れるように権限を自動設定します。

> **⚠️ 注意:** ボイスチャンネル「広間」は集合場所として自動生成されます。

---

## 3. 配役（キャラクター決定）

プレイヤーにキャラクター（ロール）を割り当てます。

### 🎭 役を割り当てる
!cast 役名 @プレイヤー

* **使用例:** `!cast 探偵 @田中`
* **機能:** プレイヤーにその役のロールを付与し、専用チャンネルへのリンクを案内します。
* **効果:**
    * そのプレイヤーは「自分の部屋」「全体議論」「密談部屋」が見えるようになります。
    * 他の人の部屋は見えません。

---

## 4. ゲーム中の進行（タイマー・移動）

議論時間の管理や、密談終了時の集合を行います。

### ⏳ タイマー（お知らせのみ）
!timer 分数 メモ

* **使用例:** `!timer 10 全体議論` / `!timer 5 休憩`
* **機能:** 指定した時間後にメンションで通知します（移動はしません）。

### 🏃 集合・移動（密談の終了）
!gather 分数

* **使用例1（予約）:** `!gather 10` （10分後に全員を広間へ強制移動）
* **使用例2（即時）:** `!gather` （今すぐ全員を広間へ強制移動）
* **機能:** 「密談部屋」にいるプレイヤーを、強制的に「広間」ボイスチャンネルへ移動させます。
* **除外対象:** GM、GMサブ、Botは移動せず、その場に残ります。

---

## 5. セッション終了後（片付け）

ゲームが終わったら、キャラクター情報だけをリセットします。

### 🗑️ 片付け（リセット）
!cleanup

* **機能:** 今回のセッションで使用した**「キャラクター個別の部屋」と「キャラクターのロール」のみ**を削除します。
* **残るもの（常設）:**
    * カテゴリー「マダミス会場」
    * テキスト「#gm控室」「#全体議論」
    * ボイス「広間」「密談1」「密談2」
    * ロール「GM」「GMサブ」

> 次回遊ぶ時は、また `!setup` から始めれば、会場の枠組みを再利用してスムーズに準備できます。

---

## 6. コマンド一覧表

| コマンド | 引数 | 説明 |
| :--- | :--- | :--- |
| `!setgm` | `@ユーザー` | GMロール（全権限・移動無効）を付与。 |
| `!setsub` | `@ユーザー` | GMサブロール（全権限・移動無効）を付与。 |
| `!setup` | `役名1 役名2...` | キャラの部屋とロールを作成し、会場を構築。 |
| `!cast` | `役名 @ユーザー` | プレイヤーに役職を割り当てる。 |
| `!timer` | `分数 (メモ)` | 時間経過のみを通知するタイマー。 |
| `!gather` | `(分数)` | 密談部屋のプレイヤーを「広間」へ強制移動。 |
| `!cleanup` | なし | キャラ部屋とロールのみ削除（会場は維持）。 |
